
(defun lcs (str1 str2)
  (let ((arr (make-array `(,(1+ (length str1)) ,(1+ (length str2))) :initial-element 0)))
    (loop for x from 1 to (length str1)
       do (loop for y from 1 to (length str2)
                if (char= (char str1 (1- x)) (char str2 (1- y)))
                  do (setf (aref arr x y) (1+ (aref arr (1- x) (1- y))))
                do (setf (aref arr x y) (max (aref arr x y) (aref arr (1- x) y) (aref arr x (1- y))))))
    (values (aref arr (length str1) (length str2)) arr)))


(setf a "AACCATGGTGGAGGCTTTCAAGGCATCTGGATAGCCCGTCCGACGGCAAGAATTTCGAATTCGTGGGTAGTGGAACGAGGAGGCGTAGCCACAAACCGCCTAGCAGTCTCAGGGTCTCTGAAATAAGGACTTCGAGTCAACAAAATAAATTCTAATCGCGACACCGAATGCGGGATTGGGGACAGATCACTTTCATTAGGTGTGAGACCGACTATGTGATTCCGTTTGCACAAAAAGAGCAACCATGACTCGCGTATGTCTTGGGCCCTATTTTAACCGACTCGGTATGGGGGTCAATTGTCTATTGCCCTGAGTAGTCAGATCATTCACAGGAAACAAGTCTCATGTAGCAGGCATCCCAATGATGCTACAAGCTTGTCCGGTCATCACTGATAGGATATATTTTCAAGCAGCGATCTGTGTGACTTGTTGAGCCGAGCTCTATAATCCTTGACTCATATACTTACCAAAAAAGGTACTTCACAGGGCTAAGTTGTTGCTCCACCACATGCTATTATCATGACCCCAATACATAAAGCTGGGTAAATCATGGTAATGAGTTTAGCCTTAGACGCCGTATCAGTGCTTTTGCTGTATTAAGAAAAATTGCTACTGGTGACGTAGGCGGCAATTAATATCTCTCAGTGGTCTAGAATCCGTGCGTCAGTAGCCGGCTCCTTAGTTTCACGATTTCCGCGGATTATCTCACGACTCTAAACACTCTCCAGTGAGTCATGAAGTGCCTCAGAACAGTAACGGGACTCTTGAAGCACCAACACGCGTCAGTAGGAACGCAAGACTAGACCTGAGGTATTGCCAAGCCCCTTAACAGTTGGCGGCGTCGTAGTAGAATCCTGTTCGACGGAGGGGCGCGTGGGAAAACTGCCAGACGCAAAATAAAGCATGCGCGCGTTGAAACATCATCGGAATCCCA" b "CACTCACAATGCATTGTACATCTGTGGCAAAATGGTTTGCAAACTTCTTTTTTGGACCATTATGGGTAGTTGACCAAACGATCAAGGTGTTGCATGTGTGCAGGATCATTGATAGTGAGATAAATGTTTGGGAACCGTTTAGCTGCAGGAGGAGTAGGCGTAGAGAGTCAATTCGTGATTCCAAAGCGACGTGGAGCTTGCGTCCTCTTAAAAAACACGTTCGAGCGTGGCACAGATGCTATAACGTGGTATATCCATAAATGCTGCCTACGCTTGTGGCCTCCGCTAGCGATCCGGGTAACCTATACGTGCGCATTAATCTGATGGATAGGGTACCGAACTTTCGTGCTCAGAAGCAGCAAAGATTGACGCACACGCCACCTGCTCCCCTGACACTCGCTGTTCAACATATATAATCAGCAACGAAACGTCTGCCCGCCTGAGGTGTCCCATGCTAATGGAGAGCTCTGAATCAGAGCTGTTTATTGAAGTTTAAGACACAAGGCGCCTAGCGACCTGTAAAAATACAGGCATCGCGCCATCCAGTGATCTTAGAGGGGGAATTTTCTTAGGAGCCATGAACGCCCAAGCGGGTGATCTTGTGCCTTATCATTCGGGCTTTTCTCCAGACTGTGGCATAGAAGTAACCCAATGCGGGAGGACTGAAGTGCCTTTCCAGGAGGGAAAGTGTCAAAGCTCTATTCTAGTTGGTGCATGCGGTTAATTCGTCTGCGATTCACAGTCCTGAAGGGCTGAGAAAATTAGCCTCCGGTAGAGCTGCTTAAACCGAGATTTGACTGGCCGTATCCAGTGGGACCGGACCAGTTGTGCTCAACCATGAAAGCCGTTGTCGGGCCTTATTAGGATACATATTGAGACCGATTAACATCAGTCTTGCCTATGATGCATGAGCTCTGATTCTGCGAAGGGTCCATGCTCAAGTAAATGGTCACGGGTAAAGTAGTGCGAT")
